import{_ as ge,u as he,c as V,k as c,w as F,o as fe,l as O,d as n,e as i,f as l,t as d,m as g,q as D,F as b,r as C,g as h,s as ye,v as be,n as A,h as J,x as E,y as j,p as Ce,j as we,i as ee}from"./index-301cae1a.js";import{u as me,D as Ne,S as De,_ as ke,a as Ie,c as Ae,b as K,d as Ee,e as Me,f as Q,g as Te,h as Ve,i as X,j as Oe}from"./D3Map-16acf114.js";const te=S=>(Ce("data-v-4c5ab3fb"),S=S(),we(),S),Se={class:"current-wrapper"},$e={class:"left"},Pe={class:"title"},Be=ee('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" data-v-4c5ab3fb><g clip-path="url(#clip0_133_1754)" data-v-4c5ab3fb><path fill-rule="evenodd" clip-rule="evenodd" d="M10.4998 2C9.14436 2.00012 7.80863 2.32436 6.60402 2.94569C5.39941 3.56702 4.36086 4.46742 3.575 5.57175C2.78914 6.67609 2.27878 7.95235 2.08647 9.29404C1.89417 10.6357 2.02551 12.004 2.46954 13.2846C2.91357 14.5652 3.65741 15.7211 4.639 16.6557C5.62059 17.5904 6.81147 18.2768 8.11228 18.6576C9.41309 19.0384 10.7861 19.1026 12.1168 18.8449C13.4475 18.5872 14.6972 18.015 15.7618 17.176L19.4138 20.828C19.6024 21.0102 19.855 21.111 20.1172 21.1087C20.3794 21.1064 20.6302 21.0012 20.8156 20.8158C21.001 20.6304 21.1062 20.3796 21.1084 20.1174C21.1107 19.8552 21.0099 19.6026 20.8278 19.414L17.1758 15.762C18.1638 14.5086 18.7789 13.0024 18.9509 11.4157C19.1228 9.82905 18.8446 8.22602 18.148 6.79009C17.4514 5.35417 16.3646 4.14336 15.0121 3.29623C13.6595 2.44911 12.0957 1.99989 10.4998 2ZM3.99977 10.5C3.99977 8.77609 4.68458 7.12279 5.90357 5.90381C7.12256 4.68482 8.77586 4 10.4998 4C12.2237 4 13.877 4.68482 15.096 5.90381C16.3149 7.12279 16.9998 8.77609 16.9998 10.5C16.9998 12.2239 16.3149 13.8772 15.096 15.0962C13.877 16.3152 12.2237 17 10.4998 17C8.77586 17 7.12256 16.3152 5.90357 15.0962C4.68458 13.8772 3.99977 12.2239 3.99977 10.5Z" fill="#4F8AAB" data-v-4c5ab3fb></path></g><defs data-v-4c5ab3fb><clipPath id="clip0_133_1754" data-v-4c5ab3fb><rect width="24" height="24" fill="white" data-v-4c5ab3fb></rect></clipPath></defs></svg>',1),Ue=[Be],We={class:"people-group"},Re={class:"people-container"},Fe={class:"text"},je={class:"group"},Le={class:"name"},Ye={key:0,class:"vote",src:ke},xe={key:1,class:"vote",src:Ie},ze=["src"],He={class:"detail"},Ze={class:"info"},qe={class:"total"},Ge={key:0,class:"voitView"},Je=["src","alt"],Ke={class:"item__content"},Qe={class:"content__title"},Xe={class:"party"},et={class:"content__bar"},tt={class:"progress"},ot={key:1,class:"voitView voitView--isMobile"},at={class:"item__content"},lt={class:"content__title"},st=["src","alt"],nt={class:"party"},rt={class:"content__bar"},ct={class:"progress"},it=ee('<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48" fill="none" data-v-4c5ab3fb><g clip-path="url(#clip0_200_5457)" data-v-4c5ab3fb><path d="M16 38C16 36.516 14.534 34.3 13.05 32.44C11.142 30.04 8.862 27.946 6.248 26.348C4.288 25.15 1.912 24 1.66948e-07 24M1.66948e-07 24C1.912 24 4.29 22.85 6.248 21.652C8.862 20.052 11.142 17.958 13.05 15.562C14.534 13.7 16 11.48 16 10M1.66948e-07 24L48 24" stroke="#2B2B2D" stroke-width="3" data-v-4c5ab3fb></path></g><defs data-v-4c5ab3fb><clipPath id="clip0_200_5457" data-v-4c5ab3fb><rect width="48" height="48" fill="white" transform="translate(0 48) rotate(-90)" data-v-4c5ab3fb></rect></clipPath></defs></svg>',1),ut=[it],dt=te(()=>l("div",{class:"custom-header"},[l("div",{class:"dialog-title"},"各區票數")],-1)),vt={class:"dialog-content"},pt={class:"area-wrapper"},_t={class:"search"},gt={class:"area area-left"},ht=te(()=>l("div",{class:"left-title"},[l("div",{class:"town"},"鄉鎮區"),l("div",{class:"win-vote"},"得票佔比")],-1)),ft={class:"left-info"},yt={class:"city"},bt={class:"right"},Ct={__name:"Current",setup(S){const oe=he(),v=V(()=>oe.width<=768),u=me(),w=c([{number:"1",president:"喵喵",vicePresident:"三花",party:"貓貓進步黨",img:Ae,circleImg:K,bg:Ee,color:"orange",vote:8170231},{number:"2",president:"來福",vicePresident:"旺福",party:"旺星人守護黨",img:Me,circleImg:Q,bg:Te,color:"blue",vote:5522119},{number:"3",president:"大嘴鳥",vicePresident:"波波",party:"鳥類保育黨",img:Ve,circleImg:X,bg:Oe,color:"green",vote:608590}]);c(!0),c(!0);const Z=c("1"),L=c(!1),q=c(null),Y=c(null),$=c(null),x=c([]),P=c([]),z=c([]),M=c(!1),m=c(null),f=c(null),B=c([]),U=c([]),H=c([]),k=c([{number:"1",party:"貓貓進步黨",img:K,color:"#F5A623",vote:5522119,strokeWidth:26.5},{number:"2",party:"旺星人守護黨",img:Q,color:"#4A90E2",vote:5522119,strokeWidth:26.5},{number:"3",party:"鳥類保育黨",img:X,color:"#7ED321",vote:5522119,strokeWidth:26.5}]),T=c([{city:"臺北市",party1:"",party2:"",party3:""},{city:"新北市",party1:"",party2:"",party3:""},{city:"臺中市",party1:"",party2:"",party3:""}]),N=c([]),ae=t=>{N.value=t};function le(){L.value=!0,document.body.style.overflow="hidden"}function se(){L.value=!1,document.body.style.overflow=""}const ne=V(()=>w.value.reduce((t,o)=>t+o.vote,0));V(()=>w.value.map(t=>(t.vote/ne.value*100).toFixed(2)));const re=V(()=>k.value.reduce((t,o)=>t+o.vote,0)),W=V(()=>k.value.map(t=>({...t,value:Number((t.vote/re.value*100).toFixed(2))})));function G(){T.value=Object.keys(u.districtVotes).map(t=>{const o=u.districtVotes[t];return console.log(o),{city:t,party1:o.candidate1??"",party2:o.candidate2??"",party3:o.candidate3??""}}).filter(t=>t.city!=="鄉(鎮、市、區)別"),console.log(T.value)}function y(t=[],o={},a={}){t.forEach((s,r)=>{o&&o[`candidate${r+1}`]&&(s.vote=o[`candidate${r+1}`])}),t.forEach((s,r)=>{a&&a[`candidate${r+1}`]&&(s.vote=a[`candidate${r+1}`])})}const R=async(t="L")=>{const o=t.slice(0,1),a=u.regionMap[o];if(!a){console.error("Invalid region code:",o);return}try{const s=await u.fetchRegionData(a);if(u.regionData=s,!s){console.error("No data returned for region:",a);return}const{totalVotes:r}=u.processVoteData(s);if(r===null){console.error("Invalid vote data:",r);return}y(w.value,r),y(k.value,r),G()}catch(s){console.error("Error handling region change:",s)}},ce=async t=>{const o=B.value.filter(a=>a.ID===t);N.value=[{id:t,name:o[0].NAME}],H.value=U.value.filter(a=>a.ID.slice(0,1)===t),f.value=null},ie=async t=>{const a=U.value.find(I=>I.ID.slice(0,3)===t).NAME;u.townRegionName=a;const r=u.districtVotes[a];y(w.value,null,r),y(k.value,null,r);const p=H.value.filter(I=>I.ID===t);N.value=[...N.value.slice(0,1),{id:t,name:p[0].NAME}],M.value=!1,m.value=null,f.value=null},ue=async t=>{console.log(t),await R(t),z.value=P.value.filter(o=>o.ID.slice(0,1)===t),$.value=null},de=t=>{G();const a=P.value.find(p=>p.ID.slice(0,3)===t).NAME;u.townRegionName=a;const s=T.value.find(p=>p.city===a);s?(console.log("找到的區域數據:",s),T.value=[s]):console.log("未找到匹配的區域數據"),y(w.value,null,s),y(k.value,null,s);const r=z.value.filter(p=>p.ID===t);N.value=[...N.value.slice(0,1),{id:t,name:r[0].NAME}],M.value=!1,m.value=null,f.value=null};F(Y,async(t,o)=>{if(t!==o){const a=x.value.find(s=>s.ID.slice(0,1)===t);a&&(u.cityRegionName=a.NAME)}}),F($,async t=>{if(t){const o=P.value.find(a=>a.ID.slice(0,3)===t);o&&(u.townRegionName=o.NAME)}}),F(m,async t=>{if(console.log(t),t){await R(t);const o=B.value.find(s=>s.ID.slice(0,1)===t);o&&(u.cityRegionName=o.NAME);const{totalVotes:a}=u.processVoteData(u.regionData);a&&(y(w.value,a),y(k.value,a))}}),F(f,t=>{if(t){console.log(t);const o=U.value.find(a=>a.ID.slice(0,3)===t);o&&(u.townRegionName=o.NAME),console.log(u.townRegionName)}});const ve=async()=>{try{const o=await(await fetch("/f2e-2023/map/TOWN_MOI_1120825.json")).json();B.value=o.features.map(a=>({ID:a.properties.COUNTYID,CODE:a.properties.COUNTYCODE,NAME:a.properties.COUNTYNAME})),x.value=o.features.map(a=>({ID:a.properties.COUNTYID,CODE:a.properties.COUNTYCODE,NAME:a.properties.COUNTYNAME}))}catch(t){console.error("失敗:",t)}},pe=async()=>{try{const o=await(await fetch("/map/TOWN_MOI_1120825.json")).json();U.value=o.features.map(a=>({ID:a.properties.TOWNID,CODE:a.properties.TOWNCODE,NAME:a.properties.TOWNNAME})),P.value=o.features.map(a=>({ID:a.properties.TOWNID,CODE:a.properties.TOWNCODE,NAME:a.properties.TOWNNAME}))}catch(t){console.error("失敗:",t)}},_e=()=>{M.value=!0};return fe(async()=>{await ve(),await pe(),await R("L")}),(t,o)=>{const a=O("el-button"),s=O("el-option"),r=O("el-select"),p=O("el-dialog"),I=O("el-progress");return n(),i("div",Se,[l("div",$e,[l("div",Pe,[l("p",{onClick:o[0]||(o[0]=(...e)=>t.testArea&&t.testArea(...e))},d(t.$t("current.title")),1),l("span",{class:"search",onClick:_e},Ue),g(a,{class:"onDrawer",onClick:le},{default:D(()=>[J("onDrawer")]),_:1}),g(p,{dialog:"",modelValue:M.value,"onUpdate:modelValue":o[5]||(o[5]=e=>M.value=e),title:"搜尋",width:"30%",center:"",onClose:o[6]||(o[6]=e=>(m.value="",f.value=""))},{default:D(()=>[l("span",null,[g(r,{modelValue:m.value,"onUpdate:modelValue":o[1]||(o[1]=e=>m.value=e),placeholder:t.$t("current.selectCityPlaceholder"),onChange:o[2]||(o[2]=e=>ce(m.value))},{default:D(()=>[(n(!0),i(b,null,C(B.value,e=>(n(),E(s,{key:e.ID,label:e.NAME,value:e.ID},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),g(r,{modelValue:f.value,"onUpdate:modelValue":o[3]||(o[3]=e=>f.value=e),placeholder:t.$t("current.selectNeighborhoodPlaceholder"),onChange:o[4]||(o[4]=e=>ie(f.value))},{default:D(()=>[(n(!0),i(b,null,C(H.value,e=>(n(),E(s,{key:e.ID,label:e.NAME,value:e.ID},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])])]),_:1},8,["modelValue"])]),l("div",We,[l("div",Re,[(n(!0),i(b,null,C(w.value,(e,_)=>(n(),i("div",{class:A(["people-card",{[`bg-${e.color}-light`]:v.value}]),key:_},[l("div",{class:"people-wrapper",style:j(v.value?{}:{"background-image":"url("+e.bg+")"})},[l("div",{class:A(["number",`bg-${e.color}`])},d(e.number),3),l("div",Fe,[l("div",je,d(e.party),1),l("div",Le,d(e.president)+" / "+d(e.vicePresident),1)]),Z.value==e.number&&!v.value?(n(),i("img",Ye)):h("",!0),Z.value==e.number&&v.value?(n(),i("img",xe)):h("",!0),l("img",{class:"people",src:e.img},null,8,ze),v.value?(n(),i("div",{key:2,class:"people-rwd-bg",style:j({"background-image":"url("+e.bg+")"})},null,4)):h("",!0)],4),l("div",He,[v.value?h("",!0):(n(),i("div",{key:0,class:A(["party-color",`bg-${e.color}`])},null,2)),l("div",Ze,[l("div",qe,d(e.vote)+"票",1)])])],2))),128))])]),v.value?h("",!0):(n(),i("div",Ge,[W.value.length>0?(n(!0),i(b,{key:0},C(W.value,(e,_)=>(n(),i("div",{class:A(["voitView__item",`bg-${e.color}`]),key:_},[l("img",{class:"item__people",src:e.img,alt:e.img},null,8,Je),l("div",Ke,[l("div",Qe,[l("span",{class:"number",style:j(`background-color: ${e.color}`)},d(e.number),5),l("p",Xe,d(e.party),1)]),l("div",et,[l("div",tt,[(n(),E(I,{key:e.id||_,percentage:e.value||0,color:e.color||"#4F8AAB",format:()=>e.vote!=null&&!isNaN(e.vote)?`${e.vote.toLocaleString()}票`:"0票","stroke-width":e.strokeWidth||20},null,8,["percentage","color","format","stroke-width"]))])])])],2))),128)):h("",!0)])),v.value?(n(),i("div",ot,[W.value.length>0?(n(!0),i(b,{key:0},C(W.value,(e,_)=>(n(),i("div",{class:A(["voitView__item",`bg-${e.color}`]),key:_},[l("div",at,[l("div",lt,[l("img",{class:"item__people",src:e.img,alt:e.img},null,8,st),l("span",{class:"number",style:j(`background-color: ${e.color}`)},d(e.number),5),l("p",nt,d(e.party),1)]),l("div",rt,[l("div",ct,[(n(),E(I,{key:e.id||_,percentage:e.value||0,color:e.color||"#4F8AAB",format:()=>e.vote!=null&&!isNaN(e.vote)?`${e.vote.toLocaleString()}票`:"0票","stroke-width":e.strokeWidth||20},null,8,["percentage","color","format","stroke-width"]))])])])],2))),128)):h("",!0)])):h("",!0),ye(l("div",{class:A(["nav-dialog",{"dialog-open":L.value}])},[l("div",{class:"custom-close-icon",onClick:se},ut),dt,l("div",vt,[l("div",pt,[l("div",_t,[g(a,{modelValue:q.value,"onUpdate:modelValue":o[7]||(o[7]=e=>q.value=e),class:"all-btn",onClick:o[8]||(o[8]=e=>R("L"))},{default:D(()=>[J("全臺")]),_:1},8,["modelValue"]),g(r,{modelValue:Y.value,"onUpdate:modelValue":o[9]||(o[9]=e=>Y.value=e),class:"city-select",placeholder:"縣市",onChange:ue},{default:D(()=>[(n(!0),i(b,null,C(x.value,e=>(n(),E(s,{key:e.ID,label:e.NAME,value:e.ID},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),g(r,{modelValue:$.value,"onUpdate:modelValue":o[10]||(o[10]=e=>$.value=e),class:"area-select",placeholder:"選擇鄉鎮區",onChange:de},{default:D(()=>[(n(!0),i(b,null,C(z.value,e=>(n(),E(s,{key:e.ID,label:e.NAME,value:e.ID},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),l("div",gt,[ht,l("div",ft,[(n(!0),i(b,null,C(T.value,(e,_)=>(n(),i("div",{class:"bar",key:_},[l("div",yt,d(e.city),1),g(De,{class:"city-scale-bar",aPercent:Number(e.party1),bPercent:Number(e.party2),cPercent:Number(e.party3)},null,8,["aPercent","bPercent","cPercent"])]))),128))])])])])],2),[[be,!v.value]]),h("",!0)]),l("div",bt,[g(Ne,{initialSelectArea:N.value,onUpdateSelectArea:ae},null,8,["initialSelectArea"])])])}}},Nt=ge(Ct,[["__scopeId","data-v-4c5ab3fb"]]);export{Nt as default};
